<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Be My Code - Sesli Python IDE</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- CodeMirror -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/theme/monokai.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/python/python.min.js"></script>
    
    <style>
        :root {
            --dark-bg: #1A181B;
            --accent-gold: #D7BB56;
            --text-light: #EEECEE;
            --gray-900: #111827;
        }

        /* CodeMirror Ã–zelleÅŸtirme */
        .CodeMirror {
            background-color: var(--dark-bg) !important;
            color: var(--text-light) !important;
            border-radius: 0.5rem;
            min-height: 400px;
            font-size: 16px;
            line-height: 1.6;
            font-family: 'Fira Code', 'Consolas', monospace;
        }
        
        .CodeMirror-gutters {
            background-color: var(--dark-bg) !important;
            border-right: 1px solid #333;
        }
        
        .CodeMirror-linenumber {
            color: #666 !important;
        }
        
        .CodeMirror-cursor {
            border-left: 2px solid var(--accent-gold) !important;
        }

        /* Tema Renkleri */
        .accent-color {
            color: var(--accent-gold);
        }
        
        .bg-accent {
            background-color: var(--accent-gold);
        }

        /* Mikrofon Butonu AnimasyonlarÄ± */
        .voice-btn {
            transition: all 0.3s ease;
        }
        
        .voice-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(215, 187, 86, 0.6);
        }
        
        .voice-btn.listening {
            animation: pulse-grow 1.2s ease-in-out infinite;
        }

        @keyframes pulse-grow {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 10px rgba(215, 187, 86, 0.5);
            }
            50% {
                transform: scale(1.08);
                box-shadow: 0 0 30px rgba(215, 187, 86, 1);
            }
        }

        /* Terminal Ã‡Ä±ktÄ± Stili */
        #terminalOutput {
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 14px;
            line-height: 1.5;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .CodeMirror {
                min-height: 300px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen">

    <!-- Ana Konteyner -->
    <div id="app" class="max-w-7xl mx-auto p-4 md:p-8">
        
        <!-- BaÅŸlÄ±k BÃ¶lÃ¼mÃ¼ -->
        <header class="text-center mb-6">
            <h1 class="text-5xl font-bold mb-2">
                <span class="accent-color">Be My Code</span>
            </h1>
            <p class="text-gray-400 text-lg mb-4">
                GÃ¶rme Engelli Bireyler Ä°Ã§in Gemini AI Destekli Python IDE
            </p>
            
            <!-- Proje Bilgileri -->
            <div class="bg-gray-800/50 rounded-lg p-4 max-w-2xl mx-auto">
                <p class="text-sm text-gray-400 mb-2">
                    <strong class="accent-color">TÃœBÄ°TAK 2209-A Projesi</strong>
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-2 text-xs text-gray-500">
                    <div>
                        <strong>Proje Sahibi:</strong><br>Erol IÅŸÄ±ldak
                    </div>
                    <div>
                        <strong>DanÄ±ÅŸman:</strong><br>Ã–ÄŸr. GÃ¶r. GÃ¼lsÃ¼m KEMERLÄ°
                    </div>
                    <div>
                        <strong>Kurum:</strong><br>Nuh Naci Yazgan Ãœniversitesi
                    </div>
                </div>
            </div>
        </header>

        <!-- Ana Grid Layout: EditÃ¶r + Sesli Kontrol + Terminal -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            
            <!-- Sol Kolon: EditÃ¶r + Terminal -->
            <div class="lg:col-span-2 space-y-6">
                
                <!-- Kod EditÃ¶r BÃ¶lÃ¼mÃ¼ -->
                <section>
                    <div class="bg-[#1A181B] rounded-xl shadow-2xl p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-2xl font-semibold accent-color flex items-center gap-2">
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M12.316 3.051a1 1 0 01.633 1.265l-4 12a1 1 0 11-1.898-.632l4-12a1 1 0 011.265-.633zM5.707 6.293a1 1 0 010 1.414L3.414 10l2.293 2.293a1 1 0 11-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0zm8.586 0a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 11-1.414-1.414L16.586 10l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                                </svg>
                                Python EditÃ¶r
                            </h2>
                            <button id="runCodeBtn" class="flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-5 rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.26a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                Ã‡alÄ±ÅŸtÄ±r
                            </button>
                        </div>
                        <textarea id="codeEditor" class="hidden"></textarea>
                    </div>
                </section>

                <!-- Terminal Ã‡Ä±ktÄ± BÃ¶lÃ¼mÃ¼ -->
                <section>
                    <div class="bg-[#1A181B] rounded-xl shadow-2xl p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center gap-2">
                                <svg class="w-6 h-6 text-emerald-400" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M2 5a2 2 0 012-2h12a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V5zm3.293 1.293a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 01-1.414-1.414L7.586 10 5.293 7.707a1 1 0 010-1.414zM11 12a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path>
                                </svg>
                                <h2 class="text-2xl font-semibold text-emerald-400">Output</h2>
                            </div>
                            <button id="visualizeBtn" class="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white text-sm py-2 px-4 rounded-lg transition-all duration-200">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                </svg>
                                Visualize Code
                            </button>
                        </div>

                        <!-- Status Banner -->
                        <div id="statusBanner" class="hidden mb-4 p-4 rounded-lg flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <span id="statusIcon" class="text-2xl"></span>
                                <span id="statusText" class="font-semibold text-lg"></span>
                            </div>
                            <button id="aiExplainBtn" class="hidden flex items-center gap-2 bg-blue-500 hover:bg-blue-600 text-white text-sm py-2 px-4 rounded-lg transition-all duration-200 shadow-md">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path>
                                </svg>
                                AI Explain
                            </button>
                        </div>

                        <!-- Metrics -->
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div class="bg-gray-900 p-3 rounded-lg">
                                <div class="text-gray-400 text-sm">Time:</div>
                                <div id="executionTime" class="text-white font-semibold">0.0000 secs</div>
                            </div>
                            <div class="bg-gray-900 p-3 rounded-lg">
                                <div class="text-gray-400 text-sm">Memory:</div>
                                <div id="executionMemory" class="text-white font-semibold">0 MB</div>
                            </div>
                        </div>

                        <!-- Terminal Output -->
                        <div class="bg-gray-900 rounded-lg p-4 min-h-[200px] max-h-[400px] overflow-auto">
                            <pre id="terminalOutput" class="text-green-400 font-mono text-sm whitespace-pre-wrap">Uygulama baÅŸlatÄ±ldÄ±. Kodu Ã§alÄ±ÅŸtÄ±rmak iÃ§in 'Ã‡alÄ±ÅŸtÄ±r' butonuna basÄ±n.</pre>
                        </div>

                        <!-- Error Details (CodeChef style) -->
                        <div id="errorContainer" class="hidden mt-4 space-y-3">
                            <!-- Runtime Error Section -->
                            <div id="runtimeErrorSection" class="hidden bg-red-900/20 border border-red-500/30 rounded-lg p-4">
                                <h3 class="text-red-400 font-semibold text-sm mb-2">Runtime Error</h3>
                                <pre id="runtimeError" class="text-red-300 text-sm font-mono bg-gray-900 p-3 rounded"></pre>
                            </div>

                            <!-- Syntax Error Section -->
                            <div id="syntaxErrorSection" class="hidden bg-orange-900/20 border border-orange-500/30 rounded-lg p-4">
                                <h3 class="text-orange-400 font-semibold text-sm mb-2">Error</h3>
                                <pre id="syntaxError" class="text-orange-300 text-sm font-mono bg-gray-900 p-3 rounded whitespace-pre-wrap"></pre>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- SaÄŸ Kolon: Sesli Komut Kontrol Paneli -->
            <div class="lg:col-span-1">
                <section class="sticky top-4">
                    <div class="bg-gray-800 rounded-xl shadow-lg p-6">
                        <div class="flex flex-col items-center space-y-5">
                            
                            <!-- Mikrofon Butonu -->
                            <button id="voiceCommandBtn" class="voice-btn w-24 h-24 rounded-full bg-accent text-gray-900 flex items-center justify-center shadow-2xl focus:outline-none focus:ring-4 focus:ring-[#D7BB56]/60" aria-label="Sesli komut">
                                <svg id="micIcon" class="w-12 h-12" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"></path>
                                    <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"></path>
                                </svg>
                                <svg id="loaderIcon" class="w-12 h-12 animate-spin hidden" viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"></circle>
                                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                </svg>
                            </button>

                            <!-- Durum MesajlarÄ± -->
                            <div class="text-center space-y-2">
                                <p id="statusMessage" class="text-lg font-medium text-gray-300">
                                    BaÅŸlamak iÃ§in mikrofona tÄ±klayÄ±n (Ctrl+M)
                                </p>
                                <p id="ttsStatus" class="text-sm text-gray-500">
                                    Sesli geri bildirim hazÄ±r
                                </p>
                            </div>
                            
                            <!-- HÄ±zlÄ± Komut ButonlarÄ± -->
                            <div class="flex flex-wrap justify-center gap-3 pt-3">
                                <button onclick="App.simulateCommand('for dÃ¶ngÃ¼sÃ¼ yaz')" class="quick-cmd-btn">
                                    For DÃ¶ngÃ¼sÃ¼
                                </button>
                                <button onclick="App.simulateCommand('string deÄŸiÅŸken tanÄ±mla isim')" class="quick-cmd-btn">
                                    String DeÄŸiÅŸken
                                </button>
                                <button onclick="App.simulateCommand('print fonksiyonu yaz Merhaba DÃ¼nya')" class="quick-cmd-btn">
                                    Print Yaz
                                </button>
                                <button onclick="App.simulateCommand('kodu sesli oku')" class="quick-cmd-btn">
                                    Kodu Oku
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

        </div>

    </div>

    <style>
        .quick-cmd-btn {
            @apply text-sm px-4 py-2 rounded-full border border-[#D7BB56]/50 text-[#D7BB56] hover:bg-[#D7BB56]/10 transition-all duration-200;
        }
    </style>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const appId = typeof __app_id === 'undefined' ? 'default-app-id' : __app_id;
        const firebaseConfig = typeof __firebase_config === 'undefined' ? null : JSON.parse(__firebase_config);
        const initialAuthToken = typeof __initial_auth_token === 'undefined' ? null : __initial_auth_token;

        let db, auth, userId;

        if (firebaseConfig) {
            try {
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);
                setLogLevel('error');

                globalThis.db = db;
                globalThis.auth = auth;

                onAuthStateChanged(auth, async (user) => {
                    if (user) {
                        userId = user.uid;
                        console.log("Firebase Auth Ready. User ID:", userId);
                        globalThis.userId = userId;
                    } else {
                        try {
                            if (initialAuthToken) {
                                const userCredential = await signInWithCustomToken(auth, initialAuthToken);
                                userId = userCredential.user.uid;
                                console.log("Custom Token Sign-In. User ID:", userId);
                            } else {
                                const userCredential = await signInAnonymously(auth);
                                userId = userCredential.user.uid;
                                console.log("Anonymous Sign-In. User ID:", userId);
                            }
                            globalThis.userId = userId;
                        } catch (error) {
                            console.error("Firebase Auth Error:", error);
                            userId = crypto.randomUUID();
                            globalThis.userId = userId;
                        }
                    }
                });
            } catch (error) {
                console.error("Firebase Init Error:", error);
            }
        }
    </script>
    
    <script>
        // ==========================================
        // BE MY CODE - Ana Uygulama ModÃ¼lÃ¼
        // ==========================================

        const App = (() => {
            // KonfigÃ¼rasyon
            const CONFIG = {
                GEMINI_API_KEY: "AIzaSyCMAcbLrhsR8EqUfOgr7SmKTvPTeQU0ZkQ",
                TEXT_MODEL: 'gemini-2.5-flash-preview-09-2025',
                TTS_MODEL: 'gemini-2.5-flash-preview-tts',
                SYSTEM_PROMPT: String.raw`Sen gÃ¶rme engelli bir Ã¶ÄŸrenci iÃ§in Ã§alÄ±ÅŸan, W3Schools Python Tutorial'Ä±na gÃ¶re eÄŸitilmiÅŸ bir Python kod asistanÄ±sÄ±n.

ðŸŽ“ EÄžÄ°TÄ°M KAYNAÄžI: https://www.w3schools.com/python/default.asp

ðŸ“‹ TEMEL KURALLER:
- SADECE saf Python kodu dÃ¶ndÃ¼r
- AÃ§Ä±klama, yorum veya ek metin YASAK
- Python 3.8+ syntax kullan
- W3Schools best practices takip et

ðŸ“š W3SCHOOLS PYTHON TUTORIAL - EKSIKSIZ MÃœFREDAT:

=== PYTHON BASICS ===
1. Python HOME - Python'a giriÅŸ ve tanÄ±tÄ±m
2. Python Intro - Python nedir, neden kullanÄ±lÄ±r
3. Python Get Started - Kurulum ve ilk program
4. Python Syntax - SÃ¶zdizimi kurallarÄ± ve girintileme
5. Python Comments - Tek satÄ±r (#) ve Ã§ok satÄ±rlÄ± (""") yorumlar
6. Python Variables - DeÄŸiÅŸken tanÄ±mlama, snake_case
7. Python Data Types - str, int, float, bool, list, tuple, dict, set
8. Python Numbers - int, float, complex sayÄ±lar
9. Python Casting - int(), float(), str() dÃ¶nÃ¼ÅŸÃ¼mleri
10. Python Strings - String tanÄ±mlama, indexing, slicing
11. Python Booleans - True, False, bool()
12. Python Operators - Aritmetik (+,-,*,/,//,%,**), karÅŸÄ±laÅŸtÄ±rma (==,!=,>,<), mantÄ±ksal (and,or,not)
13. Python Lists - Listeler, indexing, slicing, deÄŸiÅŸtirilebilir
14. Python Tuples - Tuple'lar, immutable, parantez ()
15. Python Sets - KÃ¼meler, unique deÄŸerler, sÃ¼slÃ¼ parantez {}
16. Python Dictionaries - Key-value Ã§iftleri, {"key": "value"}

=== PYTHON CONTROL FLOW ===
17. Python If...Else - if, elif, else koÅŸul yapÄ±larÄ±
18. Python Match (Python 3.10+) - match-case pattern matching
19. Python While Loops - while dÃ¶ngÃ¼sÃ¼, break, continue
20. Python For Loops - for dÃ¶ngÃ¼sÃ¼, range(), enumerate()

=== PYTHON FUNCTIONS ===
21. Python Functions - def keyword, parametreler, return
22. Python Lambda - Anonim fonksiyonlar: lambda x: x * 2
23. Python Arrays - array modÃ¼lÃ¼, array.array()
24. Python Classes/Objects - class tanÄ±mlama, __init__, self
25. Python Inheritance - class Child(Parent), super()
26. Python Iterators - iter(), next(), __iter__, __next__
27. Python Polymorphism - Method overriding, duck typing
28. Python Scope - LEGB: Local, Enclosing, Global, Built-in
29. Python Modules - import, from...import, __name__
30. Python Dates - datetime modÃ¼lÃ¼, strftime(), strptime()
31. Python Math - math modÃ¼lÃ¼, sqrt(), ceil(), floor()
32. Python JSON - json.loads(), json.dumps(), serialize
33. Python RegEx - re modÃ¼lÃ¼, search(), match(), findall()
34. Python PIP - pip install, pip list, pip uninstall
35. Python Try...Except - try, except, else, finally, raise

=== PYTHON FILE HANDLING ===
36. Python File Handling - Dosya iÅŸlemleri overview
37. Python Read Files - open('file', 'r'), read(), readline()
38. Python Write/Create Files - open('file', 'w'), write()
39. Python Delete Files - os.remove(), os.rmdir()

=== PYTHON MODULES ===
40. NumPy Tutorial - Arrays, ndarray, matematik iÅŸlemleri
41. Pandas Tutorial - DataFrame, Series, data analizi
42. SciPy Tutorial - Bilimsel hesaplama
43. Django Tutorial - Web framework
44. Python MySQL - MySQL baÄŸlantÄ±sÄ±, CRUD iÅŸlemleri
45. Python MongoDB - MongoDB baÄŸlantÄ±sÄ±, NoSQL

=== PYTHON REFERENCE ===
46. Python Reference - Genel referans dokÃ¼mantasyonu
47. Python Keywords - and, or, not, if, for, while, def, class, import...
48. Python Built-in Functions - print(), len(), type(), range(), input()...
49. Python String Methods - upper(), lower(), strip(), split(), join(), replace(), find(), count()
50. Python List Methods - append(), extend(), insert(), remove(), pop(), sort(), reverse(), clear()
51. Python Dictionary Methods - keys(), values(), items(), get(), pop(), update(), clear()
52. Python Tuple Methods - count(), index()
53. Python Set Methods - add(), remove(), discard(), union(), intersection(), difference()
54. Python File Methods - read(), readline(), readlines(), write(), close()
55. Python Exceptions - ValueError, TypeError, KeyError, IndexError, ZeroDivisionError...
56. Python Glossary - Terimler sÃ¶zlÃ¼ÄŸÃ¼

ðŸ’¡ Ã–RNEKLERÄ° KULLANARAK Ã–ÄžRENÄ°N:

ðŸ”¹ Variables & Data Types:
"string deÄŸiÅŸken oluÅŸtur isim" â†’ isim = "Ahmet"
"integer deÄŸiÅŸken oluÅŸtur yaÅŸ" â†’ yas = 25
"float deÄŸiÅŸken oluÅŸtur boy" â†’ boy = 1.75
"boolean deÄŸiÅŸken oluÅŸtur aktif" â†’ aktif = True
"liste oluÅŸtur ÅŸehirler" â†’ sehirler = ["Ä°stanbul", "Ankara", "Ä°zmir"]
"tuple oluÅŸtur koordinat" â†’ koordinat = (41.0082, 28.9784)
"dictionary oluÅŸtur kiÅŸi" â†’ kisi = {"ad": "Ali", "yas": 30, "meslek": "MÃ¼hendis"}
"set oluÅŸtur sayÄ±lar" â†’ sayilar = {1, 2, 3, 4, 5}

ðŸ”¹ Strings:
"string birleÅŸtir" â†’ mesaj = "Merhaba " + "DÃ¼nya"
"f-string kullan" â†’ ad = "AyÅŸe"
metin = f"Benim adÄ±m {ad}"
"string metodu upper" â†’ kelime = "python"
kelime_buyuk = kelime.upper()
"string split" â†’ cumle = "Python Ã¶ÄŸreniyorum"
kelimeler = cumle.split()

ðŸ”¹ Lists:
"listeye eleman ekle append" â†’ liste = [1, 2, 3]
liste.append(4)
"listeden eleman Ã§Ä±kar remove" â†’ liste = ["a", "b", "c"]
liste.remove("b")
"listeyi sÄ±rala" â†’ sayilar = [5, 2, 8, 1]
sayilar.sort()
"liste comprehension" â†’ kareler = [x**2 for x in range(10)]

ðŸ”¹ Dictionaries:
"dictionary'ye eleman ekle" â†’ kisi = {"ad": "Mehmet"}
kisi["yas"] = 25
"dictionary key'leri al" â†’ anahtarlar = kisi.keys()
"dictionary value'larÄ± al" â†’ degerler = kisi.values()
"dictionary get metodu" â†’ yas = kisi.get("yas", 0)

ðŸ”¹ Control Flow:
"if else yaz" â†’ if x > 0:
    print("Pozitif")
else:
    print("Negatif")

"if elif else yaz" â†’ if not > 90:
    print("A")
elif not > 80:
    print("B")
else:
    print("C")

ðŸ”¹ Loops:
"for dÃ¶ngÃ¼sÃ¼ range" â†’ for i in range(10):
    print(i)

"for dÃ¶ngÃ¼sÃ¼ liste" â†’ meyveler = ["elma", "armut", "muz"]
for meyve in meyveler:
    print(meyve)

"while dÃ¶ngÃ¼sÃ¼" â†’ sayac = 0
while sayac < 5:
    print(sayac)
    sayac += 1

"for enumerate" â†’ for index, deger in enumerate(liste):
    print(f"{index}: {deger}")

ðŸ”¹ Functions:
"fonksiyon yaz toplama" â†’ def toplama(a, b):
    return a + b

"fonksiyon default parametre" â†’ def selamla(ad="Misafir"):
    return f"Merhaba {ad}"

"lambda fonksiyon kare" â†’ kare = lambda x: x ** 2

"lambda fonksiyon filter" â†’ sayilar = [1, 2, 3, 4, 5]
ciftler = list(filter(lambda x: x % 2 == 0, sayilar))

ðŸ”¹ Classes & OOP:
"class yaz araba" â†’ class Araba:
    def __init__(self, marka, model):
        self.marka = marka
        self.model = model
    
    def bilgi(self):
        return f"{self.marka} {self.model}"

"class inheritance yaz" â†’ class Otomobil(Araba):
    def __init__(self, marka, model, yakit):
        super().__init__(marka, model)
        self.yakit = yakit

ðŸ”¹ File Handling:
"dosya oku" â†’ with open('dosya.txt', 'r', encoding='utf-8') as f:
    icerik = f.read()

"dosya yaz" â†’ with open('dosya.txt', 'w', encoding='utf-8') as f:
    f.write("Merhaba DÃ¼nya")

"dosya satÄ±r satÄ±r oku" â†’ with open('dosya.txt', 'r', encoding='utf-8') as f:
    for satir in f:
        print(satir.strip())

ðŸ”¹ Exception Handling:
"try except yaz" â†’ try:
    sonuc = 10 / 0
except ZeroDivisionError as e:
    print(f"Hata: {e}")

"try except else finally" â†’ try:
    dosya = open('test.txt', 'r')
except FileNotFoundError:
    print("Dosya bulunamadÄ±")
else:
    print("Dosya aÃ§Ä±ldÄ±")
finally:
    print("Ä°ÅŸlem tamamlandÄ±")

ðŸ”¹ Modules:
"datetime kullan" â†’ from datetime import datetime
simdi = datetime.now()
print(simdi.strftime("%Y-%m-%d %H:%M:%S"))

"math modÃ¼lÃ¼" â†’ import math
karekok = math.sqrt(16)
yuvarla_yukari = math.ceil(4.3)

"json yaz" â†’ import json
veri = {"ad": "Ali", "yas": 30}
json_str = json.dumps(veri, ensure_ascii=False)

"json oku" â†’ import json
json_str = '{"ad": "Ali", "yas": 30}'
veri = json.loads(json_str)

ðŸ”¹ RegEx:
"regex search" â†’ import re
metin = "Python 3.8 sÃ¼rÃ¼mÃ¼"
sonuc = re.search(r'\d+\.\d+', metin)

"regex findall" â†’ import re
email = "test@example.com"
eslesme = re.findall(r'\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b', email)

ðŸ”¹ List Comprehension:
"list comprehension kareler" â†’ kareler = [x**2 for x in range(10)]

"list comprehension filtreleme" â†’ cift_kareler = [x**2 for x in range(10) if x % 2 == 0]

ðŸ”¹ Advanced:
"enumerate kullan" â†’ for i, val in enumerate(liste, start=1):
    print(f"{i}. {val}")

"zip kullan" â†’ isimler = ["Ali", "Veli"]
yaslar = [25, 30]
for isim, yas in zip(isimler, yaslar):
    print(f"{isim}: {yas}")

"map kullan" â†’ sayilar = [1, 2, 3, 4]
kareler = list(map(lambda x: x**2, sayilar))

âš ï¸ HATIRLATMA: SADECE KOD DÃ–NDÃœR, HÄ°Ã‡BÄ°R AÃ‡IKLAMA YAZMA!`,
                DEFAULT_CODE: "# Sesli komutunuzu bekliyorum: 'for dÃ¶ngÃ¼sÃ¼ yaz' veya 'print yaz'",
                PROMPT_FILE: 'prompts/python-knowledge-complete.txt' // W3Schools'dan scrape edilmiÅŸ tam bilgi tabanÄ±
            };

            // System Prompt'u dosyadan yÃ¼kle
            async function loadSystemPrompt() {
                try {
                    const response = await fetch(CONFIG.PROMPT_FILE);
                    if (response.ok) {
                        CONFIG.SYSTEM_PROMPT = await response.text();
                        console.log('âœ… Python bilgi tabanÄ± yÃ¼klendi:', CONFIG.PROMPT_FILE);
                    } else {
                        console.warn('âš ï¸ Prompt dosyasÄ± yÃ¼klenemedi, varsayÄ±lan kullanÄ±lÄ±yor');
                    }
                } catch (error) {
                    console.error('âŒ Prompt yÃ¼kleme hatasÄ±:', error);
                }
            }

            // State
            const state = {
                editor: null,
                recognition: null,
                isListening: false,
                lastCursorLine: 0
            };

            // DOM Elements
            const elements = {
                statusMessage: document.getElementById('statusMessage'),
                ttsStatus: document.getElementById('ttsStatus'),
                voiceCommandBtn: document.getElementById('voiceCommandBtn'),
                terminalOutput: document.getElementById('terminalOutput'),
                micIcon: document.getElementById('micIcon'),
                loaderIcon: document.getElementById('loaderIcon'),
                runCodeBtn: document.getElementById('runCodeBtn'),
                // CodeChef style elements
                statusBanner: document.getElementById('statusBanner'),
                statusIcon: document.getElementById('statusIcon'),
                statusText: document.getElementById('statusText'),
                aiExplainBtn: document.getElementById('aiExplainBtn'),
                executionTime: document.getElementById('executionTime'),
                executionMemory: document.getElementById('executionMemory'),
                errorContainer: document.getElementById('errorContainer'),
                runtimeErrorSection: document.getElementById('runtimeErrorSection'),
                runtimeError: document.getElementById('runtimeError'),
                syntaxErrorSection: document.getElementById('syntaxErrorSection'),
                syntaxError: document.getElementById('syntaxError'),
                visualizeBtn: document.getElementById('visualizeBtn')
            };

            // ==========================================
            // YardÄ±mcÄ± Fonksiyonlar
            // ==========================================

            const Utils = {
                base64ToArrayBuffer(base64) {
                    const binaryString = globalThis.atob(base64);
                    const len = binaryString.length;
                    const bytes = new Uint8Array(len);
                    for (let i = 0; i < len; i++) {
                        bytes[i] = binaryString.codePointAt(i);
                    }
                    return bytes.buffer;
                },

                writeString(view, offset, string) {
                    for (let i = 0; i < string.length; i++) {
                        view.setUint8(offset + i, string.codePointAt(i));
                    }
                },

                pcmToWav(pcm16, sampleRate) {
                    const numChannels = 1;
                    const bytesPerSample = 2;
                    const blockAlign = numChannels * bytesPerSample;
                    const byteRate = sampleRate * blockAlign;
                    const dataSize = pcm16.length * bytesPerSample;
                    const buffer = new ArrayBuffer(44 + dataSize);
                    const view = new DataView(buffer);

                    let offset = 0;

                    this.writeString(view, offset, 'RIFF'); offset += 4;
                    view.setUint32(offset, 36 + dataSize, true); offset += 4;
                    this.writeString(view, offset, 'WAVE'); offset += 4;

                    this.writeString(view, offset, 'fmt '); offset += 4;
                    view.setUint32(offset, 16, true); offset += 4;
                    view.setUint16(offset, 1, true); offset += 2;
                    view.setUint16(offset, numChannels, true); offset += 2;
                    view.setUint32(offset, sampleRate, true); offset += 4;
                    view.setUint32(offset, byteRate, true); offset += 4;
                    view.setUint16(offset, blockAlign, true); offset += 2;
                    view.setUint16(offset, 16, true); offset += 2;

                    this.writeString(view, offset, 'data'); offset += 4;
                    view.setUint32(offset, dataSize, true);

                    const pcmBytes = new Uint8Array(buffer, 44);
                    const pcmView = new DataView(pcmBytes.buffer);
                    for (let i = 0; i < pcm16.length; i++) {
                        pcmView.setInt16(i * bytesPerSample, pcm16[i], true);
                    }

                    return new Blob([buffer], { type: 'audio/wav' });
                },

                async fetchWithRetry(url, options, maxRetries = 5) {
                    for (let i = 0; i < maxRetries; i++) {
                        try {
                            const response = await fetch(url, options);
                            if (response.ok) {
                                return response;
                            } else if (response.status === 429 && i < maxRetries - 1) {
                                const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                                console.warn(`API Rate Limit. Retrying in ${Math.round(delay / 1000)}s...`);
                                await new Promise(resolve => setTimeout(resolve, delay));
                            } else {
                                throw new Error(`API Error: HTTP ${response.status} - ${response.statusText}`);
                            }
                        } catch (error) {
                            if (i === maxRetries - 1) throw error;
                            const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                            console.error(`Fetch Error: ${error.message}. Retrying in ${Math.round(delay / 1000)}s...`);
                            await new Promise(resolve => setTimeout(resolve, delay));
                        }
                    }
                }
            };

            // ==========================================
            // UI YÃ¶netimi
            // ==========================================

            const UI = {
                setStatus(message, isLoading = false, isError = false) {
                    elements.statusMessage.textContent = message;
                    elements.statusMessage.classList.remove('text-gray-300', 'text-red-500', 'accent-color');
                    elements.micIcon.classList.toggle('hidden', isLoading);
                    elements.loaderIcon.classList.toggle('hidden', !isLoading);
                    
                    if (isError) {
                        elements.statusMessage.classList.add('text-red-500');
                    } else if (isLoading) {
                        elements.statusMessage.classList.add('accent-color');
                    } else {
                        elements.statusMessage.classList.add('text-gray-300');
                    }
                },

                setTTSStatus(message, isActive = false) {
                    elements.ttsStatus.textContent = message;
                    elements.ttsStatus.classList.toggle('accent-color', isActive);
                    elements.ttsStatus.classList.toggle('text-gray-500', !isActive);
                },

                updateTerminal(output) {
                    elements.terminalOutput.textContent = output;
                },

                appendTerminal(output) {
                    elements.terminalOutput.textContent += output;
                },

                // CodeChef style UI methods
                showStatus(type, text) {
                    elements.statusBanner.classList.remove('hidden');
                    elements.statusBanner.classList.remove('bg-green-900/20', 'bg-red-900/20', 'border-green-500/30', 'border-red-500/30');
                    
                    if (type === 'success') {
                        elements.statusBanner.classList.add('bg-green-900/20', 'border', 'border-green-500/30');
                        elements.statusIcon.textContent = 'âœ“';
                        elements.statusText.textContent = `Status: ${text}`;
                        elements.statusText.className = 'font-semibold text-lg text-green-400';
                        elements.aiExplainBtn.classList.add('hidden');
                    } else if (type === 'error') {
                        elements.statusBanner.classList.add('bg-red-900/20', 'border', 'border-red-500/30');
                        elements.statusIcon.textContent = 'âœ—';
                        elements.statusText.textContent = `Status: ${text}`;
                        elements.statusText.className = 'font-semibold text-lg text-red-400';
                        elements.aiExplainBtn.classList.remove('hidden');
                    }
                },

                updateMetrics(time, memory) {
                    elements.executionTime.textContent = `${time.toFixed(4)} secs`;
                    elements.executionMemory.textContent = `${memory.toFixed(3)} MB`;
                },

                showRuntimeError(error) {
                    elements.errorContainer.classList.remove('hidden');
                    elements.runtimeErrorSection.classList.remove('hidden');
                    elements.runtimeError.textContent = error;
                    elements.syntaxErrorSection.classList.add('hidden');
                },

                showSyntaxError(error) {
                    elements.errorContainer.classList.remove('hidden');
                    elements.syntaxErrorSection.classList.remove('hidden');
                    elements.syntaxError.textContent = error;
                    elements.runtimeErrorSection.classList.add('hidden');
                },

                hideErrors() {
                    elements.errorContainer.classList.add('hidden');
                    elements.runtimeErrorSection.classList.add('hidden');
                    elements.syntaxErrorSection.classList.add('hidden');
                    elements.statusBanner.classList.add('hidden');
                }
            };

            // ==========================================
            // Gemini API Ä°ÅŸlemleri
            // ==========================================

            const GeminiAPI = {
                async generateCode(prompt) {
                    // API anahtarÄ± kontrolÃ¼
                    if (!CONFIG.GEMINI_API_KEY || CONFIG.GEMINI_API_KEY === "") {
                        const errorMsg = "Gemini API anahtarÄ± yapÄ±landÄ±rÄ±lmamÄ±ÅŸ. LÃ¼tfen API anahtarÄ±nÄ±zÄ± ekleyin.";
                        UI.setStatus(`HATA: ${errorMsg}`, false, true);
                        console.error('âŒ API anahtarÄ± eksik!');
                        return null;
                    }

                    console.log('ðŸš€ Kod Ã¼retme isteÄŸi:', prompt);
                    UI.setStatus('â³ Kod Ã¼retiliyor...', true);
                    
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${CONFIG.TEXT_MODEL}:generateContent?key=${CONFIG.GEMINI_API_KEY}`;
                    
                    const payload = {
                        contents: [{ parts: [{ text: prompt }] }],
                        systemInstruction: { parts: [{ text: CONFIG.SYSTEM_PROMPT }] },
                        generationConfig: { temperature: 0.1 }
                    };

                    try {
                        console.log('ðŸ“¡ API Ã§aÄŸrÄ±sÄ± yapÄ±lÄ±yor...');
                        const response = await Utils.fetchWithRetry(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        
                        console.log('ðŸ“¥ API yanÄ±tÄ± alÄ±ndÄ±, iÅŸleniyor...');
                        const result = await response.json();
                        console.log('ðŸ“¦ API yanÄ±t objesi:', result);
                        
                        const generatedText = result.candidates?.[0]?.content?.parts?.[0]?.text;

                        if (generatedText) {
                            console.log('âœ… Kod baÅŸarÄ±yla Ã¼retildi:', generatedText.substring(0, 100));
                            UI.setStatus('âœ“ Kod baÅŸarÄ±yla oluÅŸturuldu.', false);
                            return generatedText.trim();
                        } else {
                            console.error('âŒ API yanÄ±tÄ±nda kod bulunamadÄ±');
                            console.error('API yanÄ±tÄ±:', JSON.stringify(result, null, 2));
                            throw new Error("API'den geÃ§erli kod yanÄ±tÄ± alÄ±namadÄ±.");
                        }
                    } catch (error) {
                        console.error("âŒ Kod Ãœretme HatasÄ±:", error);
                        console.error("Hata detayÄ±:", error.message);
                        console.error("Stack trace:", error.stack);
                        UI.setStatus(`âŒ HATA: ${error.message}`, false, true);
                        return null;
                    }
                },

                async explainError(errorText) {
                    if (!errorText || errorText.length === 0) return "Hata bulunamadÄ±.";
                    
                    // API anahtarÄ± kontrolÃ¼
                    if (!CONFIG.GEMINI_API_KEY || CONFIG.GEMINI_API_KEY === "") {
                        console.warn("âš ï¸ Gemini API anahtarÄ± yapÄ±landÄ±rÄ±lmamÄ±ÅŸ. Hata aÃ§Ä±klamasÄ± yapÄ±lamÄ±yor.");
                        return "API anahtarÄ± eksik - Hata aÃ§Ä±klamasÄ± yapÄ±lamÄ±yor.";
                    }
                    
                    console.log('ðŸ¤– AI hata aÃ§Ä±klamasÄ± isteniyor:', errorText.substring(0, 50) + '...');
                    
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${CONFIG.MODEL_NAME}:generateContent?key=${CONFIG.GEMINI_API_KEY}`;
                    
                    const prompt = `AÅŸaÄŸÄ±daki Python hatasÄ±nÄ± TÃ¼rkÃ§e olarak aÃ§Ä±kla ve nasÄ±l dÃ¼zeltileceÄŸini Ã¶ÄŸrenciye anlaÅŸÄ±lÄ±r ÅŸekilde anlat. KÄ±sa ve Ã¶z olsun (max 200 kelime).

Hata: ${errorText}

AÃ§Ä±klama:`;
                    
                    const payload = {
                        contents: [{
                            parts: [{ text: prompt }]
                        }],
                        generationConfig: {
                            temperature: 0.7,
                            maxOutputTokens: 500,
                        }
                    };
                    
                    try {
                        const response = await Utils.fetchWithRetry(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        
                        const result = await response.json();
                        const explanation = result?.candidates?.[0]?.content?.parts?.[0]?.text || "Hata aÃ§Ä±klamasÄ± oluÅŸturulamadÄ±.";
                        
                        console.log('âœ… AI aÃ§Ä±klama alÄ±ndÄ±:', explanation.substring(0, 100) + '...');
                        return explanation.trim();
                    } catch (error) {
                        console.error("âŒ AI Hata AÃ§Ä±klama HatasÄ±:", error);
                        return `Hata aÃ§Ä±klamasÄ± oluÅŸturulamadÄ±: ${error.message}`;
                    }
                },

                async speak(text, voiceName = "Kore") {
                    if (!text || text.length === 0) return;
                    
                    // API anahtarÄ± kontrolÃ¼ - TTS iÃ§in
                    if (!CONFIG.GEMINI_API_KEY || CONFIG.GEMINI_API_KEY === "") {
                        console.warn("âš ï¸ Gemini API anahtarÄ± yapÄ±landÄ±rÄ±lmamÄ±ÅŸ. TTS devre dÄ±ÅŸÄ±.");
                        UI.setTTSStatus("API anahtarÄ± eksik - Ses Ã¶zelliÄŸi devre dÄ±ÅŸÄ±", false);
                        return;
                    }
                    
                    console.log('ðŸ”Š TTS isteÄŸi:', text.substring(0, 50) + '...');
                    UI.setTTSStatus("Sesli geri bildirim oluÅŸturuluyor...", true);
                    
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${CONFIG.TTS_MODEL}:generateContent?key=${CONFIG.GEMINI_API_KEY}`;
                    
                    const payload = {
                        contents: [{ parts: [{ text: text }] }],
                        generationConfig: {
                            responseModalities: ["AUDIO"],
                            speechConfig: {
                                voiceConfig: {
                                    prebuiltVoiceConfig: { voiceName: voiceName }
                                }
                            }
                        }
                    };
                    
                    try {
                        console.log('ðŸ“¡ TTS API Ã§aÄŸrÄ±sÄ± yapÄ±lÄ±yor...');
                        const response = await Utils.fetchWithRetry(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        
                        console.log('ðŸ“¥ TTS yanÄ±tÄ± alÄ±ndÄ±');
                        const result = await response.json();
                        const part = result?.candidates?.[0]?.content?.parts?.[0];
                        const audioData = part?.inlineData?.data;
                        const mimeType = part?.inlineData?.mimeType;

                        if (audioData && mimeType?.startsWith("audio/")) {
                            console.log('ðŸŽµ Ses verisi bulundu, iÅŸleniyor...');
                            console.log('Mime type:', mimeType);
                            
                            const match = mimeType.match(/rate=(\d+)/);
                            const sampleRate = match ? Number.parseInt(match[1], 10) : 24000;
                            console.log('Sample rate:', sampleRate);
                            
                            const pcmData = Utils.base64ToArrayBuffer(audioData);
                            const pcm16 = new Int16Array(pcmData);
                            const wavBlob = Utils.pcmToWav(pcm16, sampleRate);
                            const audioUrl = URL.createObjectURL(wavBlob);
                            
                            console.log('ðŸŽ§ Ses Ã§alÄ±nÄ±yor...');
                            const audio = new Audio(audioUrl);
                            
                            await new Promise((resolve) => {
                                audio.onended = () => {
                                    console.log('âœ… Ses Ã§alma tamamlandÄ±');
                                    URL.revokeObjectURL(audioUrl);
                                    resolve();
                                };
                                audio.onerror = (e) => {
                                    console.error("âŒ Ses Ã§alma hatasÄ±:", e);
                                    console.error("Hata detayÄ±:", audio.error);
                                    UI.setTTSStatus("Ses Ã§alÄ±nÄ±rken hata: " + (audio.error?.message || 'Bilinmeyen hata'));
                                    URL.revokeObjectURL(audioUrl);
                                    resolve();
                                };
                                
                                audio.play().catch(e => {
                                    console.error("âŒ Audio.play() hatasÄ±:", e);
                                    console.error("Hata adÄ±:", e.name);
                                    console.error("Hata mesajÄ±:", e.message);
                                    
                                    if (e.name === 'NotAllowedError') {
                                        UI.setTTSStatus("âš ï¸ Ses izni gerekli. Sayfayla etkileÅŸimde bulunun.");
                                        console.warn('ðŸ’¡ Ä°pucu: Bir butona tÄ±klayÄ±n veya klavye kullanÄ±n');
                                    } else if (e.name === 'NotSupportedError') {
                                        UI.setTTSStatus("âŒ Ses formatÄ± desteklenmiyor");
                                    } else {
                                        UI.setTTSStatus("âŒ Ses hatasÄ±: " + e.message);
                                    }
                                    URL.revokeObjectURL(audioUrl);
                                    resolve();
                                });
                            });
                        } else {
                            console.error("âŒ TTS API'den ses verisi alÄ±namadÄ±");
                            console.error("API yanÄ±tÄ±:", JSON.stringify(result, null, 2));
                            UI.setTTSStatus("Ses verisi alÄ±namadÄ±");
                        }
                    } catch (error) {
                        console.error("âŒ TTS API HatasÄ±:", error);
                        console.error("Hata detayÄ±:", error.message);
                        UI.setTTSStatus(`TTS HatasÄ±: ${error.message}`);
                    } finally {
                        setTimeout(() => {
                            UI.setTTSStatus("Sesli geri bildirim hazÄ±r", false);
                        }, 2000);
                    }
                }
            };

            // ==========================================
            // Kod Ä°ÅŸlemleri
            // ==========================================

            const CodeHandler = {
                async speakCode(code) {
                    if (!code || code.trim() === "") {
                        await GeminiAPI.speak("EditÃ¶rde okunacak kod bulunmamaktadÄ±r.");
                        return;
                    }
                    
                    let speakableCode = code
                        .replaceAll(/\n/g, ". Yeni SatÄ±r. ")
                        .replaceAll(/#/g, "Yorum. ")
                        .replaceAll(/=/g, " eÅŸittir ")
                        .replaceAll(/!=/g, " eÅŸit deÄŸildir ")
                        .replaceAll(/==/g, " eÅŸittir ")
                        .replaceAll(/:/g, ". Ä°ki nokta. ")
                        .replaceAll(/\(/g, " parantez aÃ§ ")
                        .replaceAll(/\)/g, " parantez kapat ")
                        .replaceAll(/\[/g, " kÃ¶ÅŸeli parantez aÃ§ ")
                        .replaceAll(/\]/g, " kÃ¶ÅŸeli parantez kapat ")
                        .replaceAll(/'/g, " tÄ±rnak ")
                        .replaceAll(/"/g, " Ã§ift tÄ±rnak ");

                    await GeminiAPI.speak(`Åžu anki kod: ${speakableCode}`);
                },

                async readTerminal() {
                    const terminalContent = elements.terminalOutput.textContent.trim();
                    
                    if (!terminalContent || terminalContent === "") {
                        await GeminiAPI.speak("Terminal Ã§Ä±ktÄ±sÄ± boÅŸ.");
                        return;
                    }
                    
                    // Son 500 karakteri al (Ã§ok uzun olmasÄ±n)
                    const outputToRead = terminalContent.slice(-500);
                    
                    // Terminal Ã§Ä±ktÄ±sÄ±nÄ± temizle (>>> ve ekstra boÅŸluklarÄ±)
                    let cleanOutput = outputToRead
                        .replace(/>>>/g, "")
                        .replace(/\n+/g, ". ")
                        .trim();
                    
                    await GeminiAPI.speak(`Terminal Ã§Ä±ktÄ±sÄ±: ${cleanOutput}`);
                },

                async runSimulatedCode() {
                    const code = state.editor.getValue();
                    const startTime = performance.now();
                    
                    // Reset error displays
                    UI.hideErrors();
                    UI.updateTerminal(`>>> KOD Ã‡ALIÅžTIRILIYOR...\n`);
                    
                    // Syntax check
                    const syntaxError = this.checkSyntax(code);
                    if (syntaxError) {
                        const endTime = performance.now();
                        UI.showSyntaxError(syntaxError);
                        UI.showStatus('error', 'Syntax Error');
                        UI.updateMetrics((endTime - startTime) / 1000, 0);
                        await GeminiAPI.speak(`Syntax hatasÄ± bulundu: ${syntaxError.split('\n')[0]}`);
                        return;
                    }
                    
                    try {
                        const printMatches = [...code.matchAll(/print\s*\((.*?)\)/g)];
                        
                        let simulatedOutput = "";
                        let hasError = false;
                        
                        // Runtime error simulation
                        if (code.includes('10 / 0') || code.includes('1/0')) {
                            hasError = true;
                            const runtimeError = `ZeroDivisionError: division by zero
  File "main.py", line ${code.split('\n').findIndex(l => l.includes('/ 0')) + 1}
    ${code.split('\n').find(l => l.includes('/ 0'))?.trim()}
    ^^^^^^^^^^^^^^^^^^^^
ZeroDivisionError: division by zero`;
                            
                            UI.showRuntimeError(runtimeError);
                            UI.showStatus('error', 'Runtime error');
                            const endTime = performance.now();
                            UI.updateMetrics((endTime - startTime) / 1000, Math.random() * 15 + 5);
                            await GeminiAPI.speak("Runtime hatasÄ±: SÄ±fÄ±ra bÃ¶lme hatasÄ± bulundu.");
                            return;
                        }
                        
                        if (printMatches.length > 0) {
                            simulatedOutput += ">>> SimÃ¼le EdilmiÅŸ Ã‡Ä±ktÄ±:\n";
                            for (const match of printMatches) {
                                let content = match[1].trim().replaceAll(/['"]/g, '');
                                if (content.startsWith('f')) content = content.substring(1);
                                if (content.length > 50) content = content.substring(0, 50) + "... (kesildi)";
                                simulatedOutput += `${content}\n`;
                            }
                            
                            UI.appendTerminal(simulatedOutput);
                            UI.showStatus('success', 'Success');
                            
                            // Calculate metrics
                            const endTime = performance.now();
                            const executionTime = (endTime - startTime) / 1000;
                            const memoryUsage = Math.random() * 15 + 5; // Simulated memory usage
                            UI.updateMetrics(executionTime, memoryUsage);
                            
                            // Terminal Ã§Ä±ktÄ±sÄ±nÄ± sesli oku
                            await GeminiAPI.speak(`Kod baÅŸarÄ±yla Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±. Ã‡Ä±ktÄ±: ${simulatedOutput.replaceAll(/>>>/g, '').trim()}`);
                        } else {
                            simulatedOutput += ">>> Kodda 'print' ifadesi bulunamadÄ±. Ã‡Ä±ktÄ± yok.\n";
                            UI.appendTerminal(simulatedOutput);
                            UI.showStatus('success', 'Success');
                            
                            const endTime = performance.now();
                            UI.updateMetrics((endTime - startTime) / 1000, Math.random() * 10 + 3);
                            
                            await GeminiAPI.speak("Kod baÅŸarÄ±yla Ã§alÄ±ÅŸtÄ±rÄ±ldÄ± ancak print ifadesi bulunamadÄ±.");
                        }
                    } catch (e) {
                        UI.appendTerminal(`HATA: SimÃ¼lasyon sÄ±rasÄ±nda hata oluÅŸtu. ${e.message}`);
                        UI.showStatus('error', 'Runtime error');
                        await GeminiAPI.speak("SimÃ¼lasyon hatasÄ± oluÅŸtu. Kodunuzda bir problem olabilir.");
                    }
                },

                checkSyntax(code) {
                    // Basic Python syntax checks
                    const lines = code.split('\n');
                    
                    for (let i = 0; i < lines.length; i++) {
                        const line = lines[i].trim();
                        const lineNum = i + 1;
                        
                        // Check for missing parentheses in print
                        if (line.includes('print') && !line.includes('print(')) {
                            return `File "/mnt/sol.py", line ${lineNum}
  ${line}
  ${' '.repeat(line.indexOf('print'))}^^^^^
SyntaxError: Missing parentheses in call to 'print'. Did you mean print(...)?`;
                        }
                        
                        // Check for missing colons
                        if ((line.startsWith('if ') || line.startsWith('for ') || line.startsWith('while ') || 
                             line.startsWith('def ') || line.startsWith('class ')) && !line.endsWith(':')) {
                            return `File "/mnt/sol.py", line ${lineNum}
  ${line}
SyntaxError: expected ':'`;
                        }
                        
                        // Check for unmatched quotes
                        const singleQuotes = (line.match(/'/g) || []).length;
                        const doubleQuotes = (line.match(/"/g) || []).length;
                        if (singleQuotes % 2 !== 0 || doubleQuotes % 2 !== 0) {
                            return `File "/mnt/sol.py", line ${lineNum}
  ${line}
SyntaxError: unterminated string literal`;
                        }
                    }
                    
                    return null;
                }
            };

            // ==========================================
            // Ses TanÄ±ma
            // ==========================================

            const VoiceRecognition = {
                setup() {
                    // TarayÄ±cÄ± kontrolÃ¼
                    if (!('webkitSpeechRecognition' in globalThis)) {
                        const errorMsg = "HATA: TarayÄ±cÄ±nÄ±z Web Speech API'yi desteklemiyor. LÃ¼tfen Chrome veya Edge kullanÄ±n.";
                        UI.setStatus(errorMsg, false, true);
                        elements.voiceCommandBtn.disabled = true;
                        console.error(errorMsg);
                        return;
                    }

                    // HTTPS kontrolÃ¼
                    if (location.protocol !== 'https:' && location.hostname !== 'localhost' && location.hostname !== '127.0.0.1') {
                        console.warn('âš ï¸ GÃ¼venlik uyarÄ±sÄ±: Mikrofon eriÅŸimi iÃ§in HTTPS Ã¶nerilir.');
                    }

                    state.recognition = new webkitSpeechRecognition();
                    state.recognition.continuous = false;
                    state.recognition.interimResults = true; // Ara sonuÃ§larÄ± gÃ¶ster
                    state.recognition.lang = 'tr-TR';
                    state.recognition.maxAlternatives = 3;
                    
                    state.recognition.onstart = () => {
                        state.isListening = true;
                        elements.voiceCommandBtn.classList.add('listening');
                        UI.setStatus('ðŸŽ¤ DÄ°NLENÄ°YOR! Åžimdi konuÅŸun...', false);
                        console.log('âœ… Mikrofon AKTIF - Dinleme BAÅžLADI');
                        console.log('â±ï¸ Dinleme sÃ¼resi: maksimum ~10 saniye');
                        console.log('ðŸ’¡ Ä°pucu: Net ve yavaÅŸ konuÅŸun');
                        
                        // Sesli uyarÄ± (opsiyonel)
                        const beep = new AudioContext();
                        const oscillator = beep.createOscillator();
                        const gainNode = beep.createGain();
                        oscillator.connect(gainNode);
                        gainNode.connect(beep.destination);
                        oscillator.frequency.value = 800;
                        gainNode.gain.value = 0.1;
                        oscillator.start();
                        oscillator.stop(beep.currentTime + 0.1);
                    };
                    
                    state.recognition.onend = () => {
                        state.isListening = false;
                        elements.voiceCommandBtn.classList.remove('listening');
                        UI.setStatus('Mikrofon kapalÄ±. Tekrar tÄ±klayÄ±n (Ctrl+M).', false);
                        console.log('Dinleme sona erdi');
                    };
                    
                    state.recognition.onerror = (event) => {
                        state.isListening = false;
                        elements.voiceCommandBtn.classList.remove('listening');
                        console.error('Speech Recognition Error:', event.error);
                        
                        let errorMsg = '';
                        switch(event.error) {
                            case 'not-allowed':
                            case 'permission-denied':
                                errorMsg = 'Mikrofon izni reddedildi. LÃ¼tfen tarayÄ±cÄ± ayarlarÄ±ndan mikrofon eriÅŸimine izin verin.';
                                break;
                            case 'no-speech':
                                errorMsg = 'Ses algÄ±lanamadÄ±. LÃ¼tfen tekrar deneyin.';
                                break;
                            case 'audio-capture':
                                errorMsg = 'Mikrofon bulunamadÄ± veya kullanÄ±labilir deÄŸil.';
                                break;
                            case 'network':
                                errorMsg = 'AÄŸ hatasÄ±. Ä°nternet baÄŸlantÄ±nÄ±zÄ± kontrol edin.';
                                break;
                            case 'aborted':
                                errorMsg = 'Dinleme iptal edildi.';
                                break;
                            default:
                                errorMsg = `Ses tanÄ±ma hatasÄ±: ${event.error}`;
                        }
                        
                        UI.setStatus(errorMsg, false, true);
                        console.error('Hata detayÄ±:', errorMsg);
                    };
                    
                    state.recognition.onresult = async (event) => {
                        console.log('ðŸ“¥ onresult triggered, toplam sonuÃ§ sayÄ±sÄ±:', event.results.length);
                        
                        // TÃ¼m sonuÃ§larÄ± logla
                        for (let i = 0; i < event.results.length; i++) {
                            const result = event.results[i];
                            const transcript = result[0].transcript;
                            const isFinal = result.isFinal;
                            console.log(`  [${i}] ${isFinal ? 'FINAL' : 'ara'}: "${transcript}"`);
                        }
                        
                        const last = event.results.length - 1;
                        const result = event.results[last];
                        const transcript = result[0].transcript;
                        const isFinal = result.isFinal;
                        const confidence = result[0].confidence;
                        
                        // Ara sonuÃ§ - sadece gÃ¶ster, iÅŸlem yapma
                        if (!isFinal) {
                            console.log('ðŸ“ Ara sonuÃ§ (iÅŸlem yapÄ±lmÄ±yor):', transcript);
                            UI.setStatus(`ðŸŽ¤ Dinleniyor: "${transcript}..."`, false);
                            return; // Ã–NEMLÄ°: Ara sonuÃ§ta iÅŸlem yapma
                        }
                        
                        // FINAL SONUÃ‡ - Ä°ÅŸleme geÃ§
                        console.log('âœ… FINAL SONUÃ‡ ALINDI:', transcript);
                        console.log('ðŸ“Š GÃ¼ven skoru:', confidence);
                        console.log('ðŸ”„ Ä°ÅŸleme baÅŸlÄ±yor...');
                        
                        UI.setStatus(`âœ“ TanÄ±ndÄ±: "${transcript}" - Ä°ÅŸleniyor...`, false);
                        
                        const lowerTranscript = transcript.toLowerCase().trim();
                        console.log('ðŸ” Lowercase metin:', lowerTranscript);
                        
                        // Komut kontrolÃ¼
                        if (lowerTranscript.includes("kodu oku") || lowerTranscript.includes("sesli oku")) {
                            console.log('â–¶ï¸ Komut: Kodu Oku');
                            await GeminiAPI.speak(`Kodu okuyorum: ${transcript}`);
                            await CodeHandler.speakCode(state.editor.getValue());
                        } else if (lowerTranscript.includes("Ã§alÄ±ÅŸtÄ±r") || lowerTranscript.includes("kodu Ã§alÄ±ÅŸtÄ±r")) {
                            console.log('â–¶ï¸ Komut: Kodu Ã‡alÄ±ÅŸtÄ±r');
                            await GeminiAPI.speak(`Kodu Ã§alÄ±ÅŸtÄ±rÄ±yorum: ${transcript}`);
                            await CodeHandler.runSimulatedCode();
                        } else if (lowerTranscript.includes("terminal oku") || lowerTranscript.includes("Ã§Ä±ktÄ± oku")) {
                            console.log('â–¶ï¸ Komut: Terminal Oku');
                            await GeminiAPI.speak(`Terminal Ã§Ä±ktÄ±sÄ±nÄ± okuyorum: ${transcript}`);
                            await CodeHandler.readTerminal();
                        } else if (lowerTranscript.includes("temizle") || lowerTranscript.includes("sil")) {
                            console.log('â–¶ï¸ Komut: Temizle');
                            await GeminiAPI.speak(`EditÃ¶rÃ¼ temizliyorum: ${transcript}`);
                            state.editor.setValue("");
                            UI.setStatus('âœ“ EditÃ¶r temizlendi', false);
                        } else {
                            console.log('â–¶ï¸ Komut: Kod Ãœret');
                            console.log('ðŸ“¤ Gemini API\'ye gÃ¶nderiliyor:', transcript);
                            
                            // Komutu tekrar et
                            await GeminiAPI.speak(`AnlaÅŸÄ±ldÄ±: ${transcript}. Kod Ã¼retiyorum.`);
                            
                            UI.setStatus(`â³ "${transcript}" iÃ§in kod Ã¼retiliyor...`, true);
                            const code = await GeminiAPI.generateCode(transcript);
                            
                            if (code) {
                                console.log('âœ… Kod baÅŸarÄ±yla Ã¼retildi:', code.substring(0, 50) + '...');
                                const currentCode = state.editor.getValue().trim();
                                const newCode = currentCode + "\n\n" + code;
                                state.editor.setValue(newCode);
                                state.editor.refresh();
                                UI.setStatus(`âœ“ Kod eklendi: "${transcript}"`, false);
                                
                                // Sesli geri bildirim
                                console.log('ðŸ”Š Sesli geri bildirim veriliyor...');
                                await GeminiAPI.speak(`Kodunuz baÅŸarÄ±yla eklendi.`);
                                console.log('âœ… Sesli geri bildirim tamamlandÄ±');
                            } else {
                                console.error('âŒ Kod Ã¼retilemedi');
                                UI.setStatus(`âŒ Kod Ã¼retilemedi`, false, true);
                                await GeminiAPI.speak(`ÃœzgÃ¼nÃ¼m, kod Ã¼retilemedi. LÃ¼tfen tekrar deneyin.`);
                            }
                        }
                    };

                    console.log('âœ“ Ses tanÄ±ma sistemi hazÄ±r');
                },

                toggle() {
                    if (!state.recognition) {
                        UI.setStatus('âŒ Ses tanÄ±ma baÅŸlatÄ±lamadÄ±. SayfayÄ± yenileyin.', false, true);
                        console.error('Recognition object bulunamadÄ±');
                        return;
                    }

                    if (state.isListening) {
                        state.recognition.stop();
                        console.log('ðŸ‘¤ KullanÄ±cÄ± dinlemeyi durdurdu');
                    } else {
                        try {
                            console.log('ðŸŽ¤ Mikrofon baÅŸlatÄ±lÄ±yor...');
                            console.log('TarayÄ±cÄ±:', navigator.userAgent);
                            console.log('Mikrofon izni durumu kontrolÃ¼...');
                            
                            // Mikrofon izni kontrolÃ¼
                            if (navigator.permissions && navigator.permissions.query) {
                                navigator.permissions.query({ name: 'microphone' })
                                    .then(permissionStatus => {
                                        console.log('Mikrofon izin durumu:', permissionStatus.state);
                                        if (permissionStatus.state === 'denied') {
                                            UI.setStatus('âŒ Mikrofon izni reddedildi! TarayÄ±cÄ± ayarlarÄ±ndan izin verin.', false, true);
                                        }
                                    })
                                    .catch(e => console.warn('Ä°zin kontrolÃ¼ yapÄ±lamadÄ±:', e));
                            }
                            
                            state.recognition.start();
                            UI.setStatus('ðŸŽ¤ Mikrofon baÅŸlatÄ±lÄ±yor... LÃ¼tfen izin verin.', false);
                        } catch (error) {
                            console.error('âŒ Mikrofon baÅŸlatma hatasÄ±:', error);
                            console.error('Hata detayÄ±:', error.name, error.message);
                            
                            if (error.name === 'InvalidStateError') {
                                UI.setStatus('âš ï¸ Mikrofon zaten Ã§alÄ±ÅŸÄ±yor. LÃ¼tfen bekleyin veya sayfayÄ± yenileyin.', false, true);
                            } else {
                                UI.setStatus('âŒ Mikrofon baÅŸlatÄ±lamadÄ±: ' + error.message, false, true);
                            }
                        }
                    }
                }
            };

            // ==========================================
            // BaÅŸlatma
            // ==========================================

            async function init() {
                // Python bilgi tabanÄ±nÄ± yÃ¼kle
                await loadSystemPrompt();
                
                const codeEditorElement = document.getElementById('codeEditor');
                state.editor = CodeMirror.fromTextArea(codeEditorElement, {
                    lineNumbers: true,
                    mode: "python",
                    theme: "monokai",
                    indentUnit: 4,
                    tabSize: 4,
                    extraKeys: {
                        "Ctrl-M": () => VoiceRecognition.toggle(),
                        "Cmd-M": () => VoiceRecognition.toggle(),
                        "F5": () => CodeHandler.runSimulatedCode(),
                        "Ctrl-R": () => CodeHandler.speakCode(state.editor.getValue()),
                    }
                });
                state.editor.setValue(CONFIG.DEFAULT_CODE);
                globalThis.editor = state.editor;

                // ============================================
                // Ä°NTERAKTÄ°F SESLÄ° GERÄ° BÄ°LDÄ°RÄ°M SÄ°STEMÄ°
                // ============================================
                let lastLineCount = state.editor.lineCount();
                let isTyping = false;
                let typingTimer = null;
                
                // Her deÄŸiÅŸiklikte sesli geri bildirim
                state.editor.on('change', async (cm, change) => {
                    const currentLineCount = cm.lineCount();
                    
                    // KullanÄ±cÄ± yazdÄ±ÄŸÄ±nda
                    if (change.origin === '+input' || change.origin === 'paste') {
                        const addedText = change.text.join(' ');
                        
                        // Typing feedback (debounced)
                        clearTimeout(typingTimer);
                        if (!isTyping) {
                            isTyping = true;
                            await GeminiAPI.speak('Kod yazÄ±yorsunuz.');
                        }
                        
                        typingTimer = setTimeout(() => {
                            isTyping = false;
                        }, 2000);
                        
                        // Ã–zel anahtar kelimeler iÃ§in anÄ±nda geri bildirim
                        if (addedText.includes('print')) {
                            await GeminiAPI.speak('Print fonksiyonu eklendi.');
                        } else if (addedText.includes('for')) {
                            await GeminiAPI.speak('For dÃ¶ngÃ¼sÃ¼ eklendi.');
                        } else if (addedText.includes('if')) {
                            await GeminiAPI.speak('If koÅŸulu eklendi.');
                        } else if (addedText.includes('def')) {
                            await GeminiAPI.speak('Fonksiyon tanÄ±mÄ± eklendi.');
                        }
                    }
                    
                    // KullanÄ±cÄ± sildiÄŸinde
                    if (change.origin === '+delete' || (change.removed && change.removed.join('').length > 0)) {
                        await GeminiAPI.speak('Kod silindi.');
                    }
                    
                    // Yeni satÄ±r eklendiÄŸinde
                    if (currentLineCount > lastLineCount) {
                        const diff = currentLineCount - lastLineCount;
                        if (diff === 1) {
                            await GeminiAPI.speak(`Yeni satÄ±r. Toplam ${currentLineCount} satÄ±r.`);
                        }
                    }
                    
                    // SatÄ±r silindiÄŸinde
                    if (currentLineCount < lastLineCount) {
                        await GeminiAPI.speak(`SatÄ±r silindi. Toplam ${currentLineCount} satÄ±r.`);
                    }
                    
                    lastLineCount = currentLineCount;
                });
                
                // Cursor hareket ettiÄŸinde
                state.editor.on('cursorActivity', async () => {
                    const cursor = state.editor.getCursor();
                    const line = cursor.line + 1;
                    
                    // Sadece ok tuÅŸlarÄ± veya click ile hareket edildiÄŸinde bildir
                    // (Her karakter giriÅŸinde bildirim olmamasÄ± iÃ§in)
                    if (state.lastCursorLine !== line && !isTyping) {
                        await GeminiAPI.speak(`SatÄ±r ${line}`);
                        state.lastCursorLine = line;
                    }
                });

                // Event Listeners
                elements.voiceCommandBtn.addEventListener('click', async () => {
                    await GeminiAPI.speak('Mikrofon aÃ§Ä±lÄ±yor. Komutunuzu sÃ¶yleyebilirsiniz.');
                    VoiceRecognition.toggle();
                });
                
                elements.runCodeBtn.addEventListener('click', async () => {
                    await GeminiAPI.speak('Kod Ã§alÄ±ÅŸtÄ±rÄ±lÄ±yor.');
                    await CodeHandler.runSimulatedCode();
                });
                
                // AI Explain Button
                elements.aiExplainBtn.addEventListener('click', async () => {
                    const errorText = elements.syntaxError.textContent || elements.runtimeError.textContent;
                    if (errorText) {
                        await GeminiAPI.speak('AI hata aÃ§Ä±klamasÄ± hazÄ±rlanÄ±yor.');
                        UI.setTTSStatus('AI aÃ§Ä±klama oluÅŸturuluyor...', true);
                        const explanation = await GeminiAPI.explainError(errorText);
                        await GeminiAPI.speak(`AI AÃ§Ä±klama: ${explanation}`);
                        alert(`ðŸ¤– AI AÃ§Ä±klama:\n\n${explanation}`);
                        UI.setTTSStatus('Sesli geri bildirim hazÄ±r', false);
                    }
                });

                // Visualize Code Button
                elements.visualizeBtn.addEventListener('click', async () => {
                    const code = state.editor.getValue();
                    if (code.trim()) {
                        await GeminiAPI.speak('Kod gÃ¶rselleÅŸtirmesi yeni sekmede aÃ§Ä±lÄ±yor.');
                        const encodedCode = encodeURIComponent(code);
                        window.open(`https://pythontutor.com/visualize.html#code=${encodedCode}&mode=edit&origin=opt-frontend.js&py=3&rawInputLstJSON=%5B%5D`, '_blank');
                    } else {
                        await GeminiAPI.speak('GÃ¶rselleÅŸtirmek iÃ§in Ã¶nce kod yazmanÄ±z gerekiyor.');
                        alert('GÃ¶rselleÅŸtirmek iÃ§in kod yazÄ±n!');
                    }
                });
                
                VoiceRecognition.setup();

                // HoÅŸ geldin mesajÄ±
                await GeminiAPI.speak('Be My Code IDE hazÄ±r. Sesli komutlar iÃ§in mikrofon butonuna tÄ±klayÄ±n veya Control M tuÅŸuna basÄ±n.');

                // API anahtarÄ± kontrolÃ¼ ve uyarÄ±
                if (!CONFIG.GEMINI_API_KEY || CONFIG.GEMINI_API_KEY === "") {
                    UI.setStatus('âš ï¸ API anahtarÄ± eksik - AI Ã¶zellikleri devre dÄ±ÅŸÄ±', false, true);
                    UI.setTTSStatus('API anahtarÄ± yapÄ±landÄ±rÄ±lmadÄ±', false);
                    console.warn('%câš ï¸ GEMINI API ANAHTARI EKSÄ°K', 'color: #D7BB56; font-size: 16px; font-weight: bold;');
                    console.warn('Kod Ã¼retme ve sesli geri bildirim Ã¶zellikleri iÃ§in Gemini API anahtarÄ± gereklidir.');
                    console.warn('API anahtarÄ±nÄ± CONFIG.GEMINI_API_KEY deÄŸiÅŸkenine ekleyin.');
                }
            }

            // ==========================================
            // Keyboard Shortcuts
            // ==========================================

            function setupKeyboardShortcuts() {
                document.addEventListener('keydown', (event) => {
                    if ((event.ctrlKey || event.metaKey) && event.key === 'm') {
                        event.preventDefault();
                        VoiceRecognition.toggle();
                    }
                    if (event.key === 'F5') {
                        event.preventDefault();
                        CodeHandler.runSimulatedCode();
                    }
                    if ((event.ctrlKey || event.metaKey) && event.key === 'r') {
                        event.preventDefault();
                        CodeHandler.speakCode(state.editor.getValue());
                    }
                });
            }

            // ==========================================
            // Public API
            // ==========================================

            return {
                init,
                setupKeyboardShortcuts,
                simulateCommand: async (command) => {
                    if (command.toLowerCase().includes("kodu oku")) {
                        await CodeHandler.speakCode(state.editor.getValue());
                    } else if (command.toLowerCase().includes("terminal oku")) {
                        await CodeHandler.readTerminal();
                    } else if (command.toLowerCase().includes("Ã§alÄ±ÅŸtÄ±r")) {
                        await CodeHandler.runSimulatedCode();
                    } else {
                        // Komutu tekrar et
                        await GeminiAPI.speak(`AnlaÅŸÄ±ldÄ±: ${command}. Kod Ã¼retiyorum.`);
                        
                        UI.setStatus(`SimÃ¼le Komut: "${command}" - Kod Ã¼retiliyor...`, true);
                        const code = await GeminiAPI.generateCode(command);
                        if (code) {
                            state.editor.setValue(state.editor.getValue().trim() + "\n\n" + code);
                            state.editor.refresh();
                            await GeminiAPI.speak(`Kodunuz baÅŸarÄ±yla eklendi.`);
                        } else {
                            await GeminiAPI.speak(`ÃœzgÃ¼nÃ¼m, kod Ã¼retilemedi.`);
                        }
                    }
                }
            };
        })();

        // ==========================================
        // Uygulama BaÅŸlat
        // ==========================================

        globalThis.onload = () => {
            App.init();
            App.setupKeyboardShortcuts();
        };

        globalThis.App = App;
        
    </script>
</body>
</html>